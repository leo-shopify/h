<!doctype html>
<title>h</title>
<body>
  <script>
    /** @jsx h */
    
    function h(node, attributes, ...children) {
      if (typeof node === 'function') {
        return node(attributes, ...children);
      }
    
      let element;
    
      if (typeof node === 'string') {
        element = document.createElement(node);
      } else if (typeof node.appendChild === 'function') {
        element = node;
      } else {
        throw new TypeError('node must be a String or an object that implements appendChild');
      }
    
      if (attributes) {
        Object.keys(attributes).forEach(k => k === '$' ? Object.assign(element, attributes.$) : element.setAttribute(k, attributes[k]));
      }
    
      return children == null ? element : children.reduce(recurse, element);
    }
    
    function recurse(node, item) {
      let child;
      if (Array.isArray(item)) {
        child = item.reduce(recurse, document.createDocumentFragment());
      } else if (item.nodeType) {
        child = item;
      } else {
        child = document.createTextNode(item);
      }
      node.appendChild(child);
      return node;
    }
    
    function Title(attr, str) {
      return h(
        'h1',
        null,
        str.toUpperCase()
      );
    }
    
    function Author(attr, ...name) {
      return h(
        'a',
        { href: `mailto:${attr.email}` },
        name
      );
    }
    
    const body = h(
      'header',
      null,
      h(
        Title,
        null,
        'Santa Maradona'
      ),
      h(
        Author,
        { email: 'mano.negra@example.com' },
        'Mano ',
        h(
          'strong',
          null,
          'Negra'
        )
      )
    );
    
    document.body.appendChild(body);
  </script>
</body>
